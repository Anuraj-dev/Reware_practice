{% extends 'base.html' %}
{% block title %}{{ item.title }} Â· Rewear{% endblock %}

{% block content %}
<section class="section">
  <div class="container">
    <div class="grid cols-2" style="align-items:start;">
      <div class="card" style="overflow:hidden;">
        <div class="media" style="aspect-ratio: 4/3; background: var(--bg-secondary);">
          {% if item.image_url %}
            <img src="{{ item.image_url }}" alt="{{ item.title }} image" style="width:100%; height:100%; object-fit:cover;">
          {% else %}
            <img src="{{ url_for('static', filename='images/image2.jpg') }}" alt="{{ item.title }} placeholder" style="width:100%; height:100%; object-fit:cover;">
          {% endif %}
        </div>
      </div>
      <div class="card card-body">
        <header style="display:grid; gap:.35rem; margin-bottom:.5rem;">
          <h1 style="margin:0; letter-spacing:-.2px;">{{ item.title }}</h1>
          <div style="display:flex; gap:.4rem; flex-wrap:wrap; align-items:center;">
            <span class="badge">{{ item.category }}</span>
            <span class="badge">{{ item.size }}</span>
            <span class="badge points" title="Points cost">{{ item.points_cost }} pts</span>
          </div>
        </header>
        {% if item.description %}
          <p class="help" style="font-size:1rem; color: var(--text-muted);">{{ item.description }}</p>
        {% endif %}
        {% if current_user %}
          <div class="card card-body" style="margin:.8rem 0;">
            <p style="margin:.2rem 0;">You have <strong>{{ current_user.points }}</strong> points.</p>
            {% if current_user.id == item.user_id %}
              <p class="help">This is your listing.</p>
            {% endif %}
          </div>
        {% endif %}
        <div style="display:flex; gap:.6rem; flex-wrap:wrap; align-items:center;">
          {% if not current_user %}
            <a class="btn" href="{{ url_for('auth.login') }}">Login to request</a>
          {% elif current_user.id == item.user_id or current_user.is_admin %}
            <a class="btn secondary" href="{{ url_for('item.renderEditPage', item_id=item.id) }}">Edit</a>
          {% else %}
            <button class="btn" disabled title="Swap functionality coming soon">Request swap ({{ item.points_cost }} pts)</button>
          {% endif %}
          <a class="btn ghost" href="{{ url_for('item.index') }}">Back to listings</a>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}
